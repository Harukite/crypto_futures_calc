# 币安API配置指南

## 概述

加密货币合约计算器已集成币安API，支持实时获取价格、手续费和杠杆信息。

## 功能说明

### 无需认证的功能（默认可用）
- ✅ **实时价格获取**：获取10种主流币种的实时价格
  - BTC (Bitcoin)
  - ETH (Ethereum)
  - BNB (Binance Coin)
  - XRP (Ripple)
  - ADA (Cardano)
  - DOGE (Dogecoin)
  - SOL (Solana)
  - DOT (Polkadot)
  - LTC (Litecoin)
  - LINK (Chainlink)

- ✅ **标准手续费**：显示币安标准交易手续费
  - Maker: 0.02%
  - Taker: 0.04%

- ✅ **杠杆信息**：显示各币种的杠杆交易限制

### 需要API密钥的功能（可选）
- 🔐 **用户特定手续费**：获取您账户的实际交易手续费（可能因VIP等级而不同）
- 🔐 **用户杠杆限制**：获取您账户的实际杠杆交易限制

## 环境变量配置

### 基础配置（可选）
```bash
# 币安API基础URL（默认为期货API）
BINANCE_API_BASE=https://fapi.binance.com

# 币安API密钥（可选，留空使用公开API）
BINANCE_API_KEY=your_api_key_here

# 币安API密钥Secret（可选，留空使用公开API）
BINANCE_API_SECRET=your_api_secret_here
```

## 如何获取API密钥

### 步骤1：登录币安账户
1. 访问 [币安官网](https://www.binance.com)
2. 登录您的账户

### 步骤2：创建API密钥
1. 点击右上角账户图标 → **API管理**
2. 点击 **创建API**
3. 输入标签名称（例如：合约计算器）
4. 选择 **现货及杠杆交易** 权限
5. 完成安全验证

### 步骤3：复制密钥
- 复制 **API Key**
- 复制 **Secret Key**

### 步骤4：配置环境变量
在项目的 `.env` 或 `.env.local` 文件中添加：
```bash
BINANCE_API_KEY=your_copied_api_key
BINANCE_API_SECRET=your_copied_secret_key
```

## API速率限制

币安API有以下速率限制：
- **权重限制**：每分钟1200个权重
- **订单限制**：每秒10个订单
- **IP限制**：每秒100个请求

本应用使用的API调用：
- 获取价格：1个权重
- 获取手续费：1个权重
- 获取杠杆信息：1个权重

**缓存策略**：所有数据缓存60秒，避免频繁调用API。

## 数据缓存

应用自动缓存以下数据：
- **价格数据**：缓存60秒
- **手续费**：缓存60秒
- **杠杆信息**：缓存60秒

前端每30秒自动刷新一次价格数据。

## 安全建议

### API密钥安全
1. **限制权限**：只授予 **现货及杠杆交易** 权限，不要授予提现权限
2. **IP白名单**：在币安API管理页面设置IP白名单
3. **定期轮换**：定期更换API密钥
4. **不要共享**：不要在代码中硬编码API密钥，使用环境变量

### 环境变量安全
- 使用 `.env.local` 文件存储敏感信息
- 将 `.env.local` 添加到 `.gitignore`
- 不要将API密钥提交到版本控制系统

## 故障排查

### 问题：无法获取价格
**解决方案**：
1. 检查网络连接
2. 确认币种代码正确（例如：BTCUSDT）
3. 检查币安API服务状态

### 问题：获取手续费失败
**解决方案**：
1. 如果配置了API密钥，检查密钥是否正确
2. 检查API密钥是否有 **现货及杠杆交易** 权限
3. 检查IP是否在白名单中

### 问题：价格更新不及时
**解决方案**：
1. 前端每30秒自动刷新一次
2. 后端缓存60秒，可以手动刷新页面强制更新
3. 检查浏览器控制台是否有错误信息

## API文档参考

- [币安现货API文档](https://binance-docs.github.io/apidocs/)
- [币安期货API文档](https://binance-docs.github.io/apidocs/futures/cn/)

## 常见问题

**Q: 不配置API密钥可以使用吗？**
A: 可以。应用会使用币安公开API获取价格和标准手续费。

**Q: 为什么有时候价格显示不出来？**
A: 可能是网络问题或币安API临时不可用。应用会自动使用缓存数据。

**Q: 可以同时监控多个币种吗？**
A: 可以。选择不同的币种会自动获取该币种的实时价格。

**Q: 手续费会影响爆仓价格计算吗？**
A: 会。手续费会增加开仓成本，从而降低爆仓价格（对多头）或提高爆仓价格（对空头）。

