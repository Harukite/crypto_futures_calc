# 加密货币合约计算器 (Crypto Futures Calculator)

> 面向币安合约交易的风险与成本计算工具。默认使用币安期货 API，以匹配合约场景的杠杆、标记价、维持保证金等数据要求。

## 功能概览

参见 `todo.md` 功能清单，已实现的核心能力包括：
- 基础合约参数输入（开仓价、保证金、杠杆倍数等）
- 爆仓价格（多/空）与维持保证金率、风险指标
- 头寸价值、所需保证金、目标价盈亏计算
- 手续费与资金费率影响（合约场景）
- 多仓位对比分析
- 支持逐仓/全仓保证金模式
- 实时价格获取与前端每 30 秒自动刷新
- API 数据缓存（默认 60 秒）

未完成项（示例）：
- 计算历史记录保存
- 结果导出
- 使用指南/教程、数据校验与错误处理、性能优化

## 为什么默认使用期货 API
- 合约特有数据：杠杆、阶梯/维持保证金、标记价、资金费率等仅在期货端提供
- 计算一致性：爆仓/强平与风险规则依赖期货专有字段
- 费率/限制差异：期货与现货费率与限制不同，直接接入期货端更贴合合约计算
- 实现简化：统一端点，减少跨现货/期货的适配复杂度

如切换到现货，请相应更改基础 URL 与端点，并调整逻辑（现货不适用期货杠杆/维持保证金/资金费率等计算）。

## 环境变量与配置

参考 `BINANCE_API_CONFIG.md`：

```bash
# 币安 API 基础 URL（默认为期货 API）
BINANCE_API_BASE=https://fapi.binance.com

# 币安 API Key / Secret（可选；留空则使用公开端点）
BINANCE_API_KEY=your_api_key_here
BINANCE_API_SECRET=your_api_secret_here
```

- 无密钥时：支持公开价格、标准费率与杠杆信息（公开数据）
- 配置密钥后：可获取账户实际费率与杠杆限制（取决于 VIP 等级与权限）

获取密钥步骤、权限与操作位置详见 `BINANCE_API_CONFIG.md` 的「如何获取API密钥」章节。

## 速率限制与缓存
- 币安常见限制：权重/订单/IP 请求频率（详情见 `BINANCE_API_CONFIG.md`）
- 本应用使用缓存 60 秒，减少请求频次；前端价格每 30 秒自动刷新

## API 密钥安全

强烈建议通读 `API_KEY_SECURITY.md`，要点摘要：
- 客户端本地加密存储（基于浏览器信息的 XOR + Base64 混淆，用于降低随意窥探风险）
- 仅通过 HTTPS 传输；后端接收后即用即弃，不做持久化，敏感信息仅存在内存中
- 后端请求使用 HMAC-SHA256 签名
- 最佳实践：最小权限、IP 白名单、定期轮换、可信设备、监控调用日志

风险提示：没有绝对安全。请定期轮换密钥、启用 IP 白名单并监控账户活动。

## 使用说明（概览）
- 打开计算器页面，输入基础合约参数即可得到风险与成本指标
- 在「币安 API 配置」卡片中可选配置 API Key/Secret，以获取账户实际费率/杠杆
- 未配置密钥时将使用公开端点与标准参数

注：本 README 不包含运行命令与部署脚本，请按你的项目实际脚本启动与部署；如需补充，请在提供脚本后完善本节。

## 参考文档
- 币安现货 API 文档：`https://binance-docs.github.io/apidocs/`
- 币安期货 API 文档：`https://binance-docs.github.io/apidocs/futures/cn/`
- 项目文档：`BINANCE_API_CONFIG.md`、`API_KEY_SECURITY.md`、`todo.md`

## 免责声明
- 本工具仅用于教育与研究目的，不构成投资建议
- 使用币安 API 与 API 密钥请遵守相关服务条款与法律法规
